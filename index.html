<!DOCTYPE html>
<html>
<head>
	<title>Vue Component</title>
	<style>
		body {
			margin: 5%;
		}
		.text-danger{
			color: red;
			transition-duration: 5s;
			transition-delay: 2s;
		}
	</style>
</head>
<body>
	<div id="app">
		<c-header message="haloo component" gambar="images/vue3.png"></c-header>
		<c-header message="haloo component lagii" gambar="images/vue2.png"></c-header>

		<nav>
			<router-link to="/">Home</router-link>
			<router-link to="/about">About</router-link>
			<router-link to="/kelas">Kelas</router-link>
		</nav>
		<main>
			<!-- <c-main :child="kelas" @submitkelas="submitKelas" @hapuskelas="hapusKelas"/> -->
			<!-- <router-view :child="kelas" @submitkelas="submitKelas" @hapuskelas="hapusKelas"></router-view> -->
			<router-view :child="kelas" @em-submitkelas="submitKelasParent" @hapuskelas="hapusKelas"></router-view>
		</main>	
		<c-footer />
	</div>

	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
	<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
	<script src="https://unpkg.com/uuid@latest/dist/umd/uuidv4.min.js"></script>
	<script>
		const Home  = { template: '<div>Ini Homee</div>' }
		const About = { template: '<div>Ini About</div>' }
		const Kelas = {
			props: ['child'],
			template: `
			<div>
			<h5>Tambah kelas dengan enter</h5>
			<form @submit.prevent="submitKelasChild">						
			<div>
			<label>Judul</label> <br>
			<input type="text" placeholder="Judul" v-model="kelas.judul">
			</div>
			<div>
			<label>Deskripsi</label> <br>
			<textarea v-model="kelas.deskripsi"></textarea>
			</div>
			<div>
			<label>Gambar</label> <br>
			<input type="file">
			</div>
			<br>
			<button type="submit">Tambahkan</button>
			</form>
			<template v-if="child.length > 0">
			<ul>
			<!-- melooping data array dan memunculkannya -->
			<li v-for="(k, index) of child">{{index+1}} - {{k.judul}} - {{k.deskripsi}}
			<!-- menghapus data menggunakan parameter index/key nya -->
			<a href="" @click.prevent="$emit('hapuskelas', k.id)">hapus</a>
			</li>
			</ul>				
			</template>
			<p v-else>
			<b>Belum  ada kelas, silakan tambahkan kelas</b>
			</p>
			<p class="text-danger" style="display: none">
			Berhasil menghapus data
			</p>
			</div>
			`,
			data: function(){
				return {
					kelas: {
						judul: '',
						deskripsi: '',
						gambar: ''
					}
				}
			},
			methods: {
				submitKelasChild: function(){
					if (this.kelas.judul && this.kelas.deskripsi) {
						const sendData = {
							id: uuidv4(),
							judul: this.kelas.judul,
							deskripsi: this.kelas.deskripsi,
							gambar: null
						}
						this.$emit('em-submitkelas', sendData)

						this.kelas.judul = ''
						this.kelas.deskripsi = ''
					}else{
						alert('masih ada yang kosong')
					}
				}
			}
		}

		const routes = [
		{ path: '/', component: Home },
		{ path: '/about', component: About },
		{ path: '/kelas', component: Kelas }
		]

		const router = new VueRouter({
			mode: 'history',
			routes
		})

		Vue.component('c-header', {			
			props: ['message', 'gambar'],
			template: `
			<header>
			<img style="height: 200px;border-radius: 10px;display: block;margin-bottom: 20px;" :src="gambar" alt="gambar">
			<p>ini {{message}}</p>
			</header>
			`,
			data: function(){
				return {
					pesan: 'Heloo, Component !'
				}
			}
		})

		Vue.component('c-footer', {
			template: `
			<footer id="footer">
			<p>copyright 2021</p>			
			</footer>
			`			
		})
		const vm = new Vue({
			el: '#app',
			router,
			data: {
				kelas: [
				{id: 1, judul: 'Ini judul PHP', deskripsi: 'Ini deskripsi PHP', gambar: 'vue.png'},
				{id: 2, judul: 'Ini judul Javascript', deskripsi: 'Ini deskripsi Javascript', gambar: 'vue2.png'},
				{id: 3, judul: 'Ini judul CSS', deskripsi: 'Ini deskripsi CSS', gambar: 'vue3.png'},
				]
			},
			methods: {
				hapusKelas: function(id){
					this.kelas = this.kelas.filter(item => item.id != id)
					document.getElementsByClassName('text-danger')[0].style.display = 'block'
					setTimeout(function(){
						document.getElementsByClassName('text-danger')[0].style.display = 'none'
					}, 5000)
				},
				submitKelasParent: function(data){
					this.kelas.push(data)
				}
			},
			computed: {

			}
		})
	</script>
</body>
</html>